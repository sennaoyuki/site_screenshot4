<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Region 004 (å®®åŸ) Ranking Test</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; background: #f9f9f9; }
        .ranking-result { margin: 10px 0; padding: 10px; background: #fff; border-left: 4px solid #e74c3c; }
        button { margin: 5px; padding: 10px; background: #e74c3c; color: white; border: none; cursor: pointer; }
        .log { background: #000; color: #0f0; padding: 10px; font-family: monospace; height: 200px; overflow-y: scroll; margin-top: 10px; }
        iframe { width: 100%; height: 300px; border: 1px solid #ccc; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Region 004 (å®®åŸ) ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="test-section">
        <h2>åœ°åŸŸå¤‰æ›´ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</h2>
        <button onclick="changeToRegion004()">å®®åŸï¼ˆ004ï¼‰ã«å¤‰æ›´</button>
        <button onclick="changeToRegion012()">åƒè‘‰ï¼ˆ012ï¼‰ã«æˆ»ã™</button>
        <button onclick="showCurrentRanking()">ç¾åœ¨ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ç¤º</button>
    </div>

    <div class="test-section">
        <h2>äºˆæƒ³ã•ã‚Œã‚‹å®®åŸã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°çµæœ</h2>
        <div class="ranking-result">
            <strong>1ä½:</strong> TCBæ±äº¬ä¸­å¤®ç¾å®¹å¤–ç§‘ ä»™å°é™¢ (æœˆã€…1,700å††)
        </div>
        <div class="ranking-result">
            <strong>2ä½:</strong> ãƒªã‚¼ã‚¯ãƒªãƒ‹ãƒƒã‚¯ ä»™å°é™¢ (æœˆã€…3,700å††)
        </div>
        <div class="ranking-result">
            <strong>3ä½:</strong> ã‚¨ãƒŸãƒŠãƒ«ã‚¯ãƒªãƒ‹ãƒƒã‚¯ (ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«3ä½æƒ…å ±ãªã—)
        </div>
    </div>

    <div class="test-section">
        <h2>04_rankingresults.html ãƒ†ã‚¹ãƒˆ</h2>
        <iframe src="04_rankingresults.html" id="rankingIframe"></iframe>
    </div>

    <div class="test-section">
        <h2>06_comparisontable.html ãƒ†ã‚¹ãƒˆ</h2>
        <iframe src="06_comparisontable.html" id="comparisonIframe"></iframe>
    </div>

    <div class="test-section">
        <h2>ãƒ­ã‚°</h2>
        <div id="log" class="log"></div>
    </div>

    <!-- ã‚·ã‚¹ãƒ†ãƒ ã®èª­ã¿è¾¼ã¿ -->
    <script src="clinic-database-generated.js"></script>
    <script src="ranking-sync-system.js"></script>

    <script>
        // ãƒ­ã‚°è¡¨ç¤ºé–¢æ•°
        function logMessage(message) {
            const logDiv = document.getElementById('log');
            const time = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${time}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ãƒ­ã‚°ã«è»¢é€
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            logMessage(args.join(' '));
        };

        const originalWarn = console.warn;
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            logMessage('âš ï¸ ' + args.join(' '));
        };

        // åœ°åŸŸå¤‰æ›´é–¢æ•°
        function changeToRegion004() {
            logMessage('ğŸ”„ å®®åŸï¼ˆ004ï¼‰ã«å¤‰æ›´ä¸­...');
            
            if (window.rankingSyncSystem) {
                window.rankingSyncSystem.updateRegion('004');
                
                // iframeã«ã‚‚åœ°åŸŸå¤‰æ›´ã‚’é€šçŸ¥
                const rankingIframe = document.getElementById('rankingIframe');
                const comparisonIframe = document.getElementById('comparisonIframe');
                
                if (rankingIframe.contentWindow && rankingIframe.contentWindow.rankingSyncSystem) {
                    rankingIframe.contentWindow.rankingSyncSystem.updateRegion('004');
                }
                
                if (comparisonIframe.contentWindow && comparisonIframe.contentWindow.rankingSyncSystem) {
                    comparisonIframe.contentWindow.rankingSyncSystem.updateRegion('004');
                }
                
                logMessage('âœ… å®®åŸï¼ˆ004ï¼‰ã«å¤‰æ›´å®Œäº†');
            } else {
                logMessage('âŒ ranking-sync-system not available');
            }
        }

        function changeToRegion012() {
            logMessage('ğŸ”„ åƒè‘‰ï¼ˆ012ï¼‰ã«æˆ»ã—ä¸­...');
            
            if (window.rankingSyncSystem) {
                window.rankingSyncSystem.updateRegion('012');
                
                // iframeã«ã‚‚åœ°åŸŸå¤‰æ›´ã‚’é€šçŸ¥
                const rankingIframe = document.getElementById('rankingIframe');
                const comparisonIframe = document.getElementById('comparisonIframe');
                
                if (rankingIframe.contentWindow && rankingIframe.contentWindow.rankingSyncSystem) {
                    rankingIframe.contentWindow.rankingSyncSystem.updateRegion('012');
                }
                
                if (comparisonIframe.contentWindow && comparisonIframe.contentWindow.rankingSyncSystem) {
                    comparisonIframe.contentWindow.rankingSyncSystem.updateRegion('012');
                }
                
                logMessage('âœ… åƒè‘‰ï¼ˆ012ï¼‰ã«æˆ»ã—å®Œäº†');
            }
        }

        function showCurrentRanking() {
            if (window.rankingSyncSystem) {
                window.rankingSyncSystem.logCurrentRanking();
            }
        }

        // iframeèª­ã¿è¾¼ã¿å®Œäº†æ™‚
        document.getElementById('rankingIframe').addEventListener('load', function() {
            logMessage('âœ… 04_rankingresults.html loaded');
        });

        document.getElementById('comparisonIframe').addEventListener('load', function() {
            logMessage('âœ… 06_comparisontable.html loaded');
        });

        logMessage('ğŸš€ Region 004 test page initialized');
    </script>
</body>
</html>